<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0">
    <!-- Add jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>Online Movie Database</title>
    <header>
        <h1>Online Movie Database<h1>
    </header>

<body>
    <main>
        <!-- Add search input -->
        <input type="text" id="search" placeholder="Search for a movie">
        <button id="searchBtn">Search</button>
        <div>
            <!-- Add results here -->
            <p id="results"></p>
        </div>
    </main>
    <script>
        var API_KEY = "7871a3a984msh9c8fac100c1803dp118287jsnb2f0f33c75ea";
        var BASE_URL = "online-movie-database.p.rapidapi.com";

        const options = {
            method: 'GET',
            headers: {
                'X-RapidAPI-Key': API_KEY,
                'X-RapidAPI-Host': BASE_URL
            }
        };

        // Add searchBtn listener
        $("#searchBtn").on("click", function (event) {
            event.preventDefault();
            $("#results").empty();

            var query = $("#search").val().trim();
            var queryURL = `https://${BASE_URL}/auto-complete/?q=${query}`;
            console.log(queryURL);

            fetch(queryURL, options)
                .then(response => response.json())
                .then(function (data) {
                    $("#results").text("URL:" + queryURL);
                    console.log(data);
                    var result = data.d;
                    for (var i = 0; i < result.length; i++) {

                        if (!result[i].q || !result[i].i)
                            continue;

                        var name = $("<a>")
                            // .attr("href", result[i].external_ids.tmdb.url)
                            .append($("<h2>").text(result[i].l));
                        var image = $("<img>")
                            .attr("src", result[i].i.imageUrl)
                            .attr("width", "80px");
                        var streaming = $("<div>");
                        // for (var j = 0; j < result[i].locations.length; j++) {
                        //     var location = $("<p>").text(result[i].locations[j].display_name);
                        var icon = $("<img>")
                            .attr("src", "https://press.aboutamazon.com/system/files-encrypted/nasdaq_kms/inline-images/Prime_0_0.jpg")
                            .attr("width", "50px");
                        //     // url.append(location);
                        streaming.append(icon);
                        // }

                        $("#results").append(name, image, streaming);

                    }
                })
                .catch(err => console.error(err));
        });
    </script>
</body>

</html>